#!/usr/bin/env php
<?php

require __DIR__ . '/vendor/autoload.php';

use NeoPhp\Console\GeneratorCommand;

$command = $argv[1] ?? null;
$type = $argv[2] ?? null;
$name = $argv[3] ?? null;

if (!$command || $command === 'help') {
    echo "NeoPhp CLI Generator\n";
    echo "====================\n\n";
    echo "Usage: php neophp generate <type> <name>\n\n";
    echo "Available types:\n";
    echo "  module      Generate a new module\n";
    echo "  controller  Generate a new controller\n";
    echo "  service     Generate a new service\n";
    echo "  repository  Generate a new repository\n";
    echo "\nExamples:\n";
    echo "  php neophp generate module User\n";
    echo "  php neophp generate controller UserController\n";
    echo "  php neophp generate service UserService\n";
    echo "  php neophp generate repository UserRepository\n";
    exit(0);
}

if ($command === 'generate') {
    if (!$type || !$name) {
        echo "Error: Missing type or name\n";
        echo "Usage: php neophp generate <type> <name>\n";
        exit(1);
    }

    $generator = new GeneratorCommand(__DIR__);
    
    try {
        switch ($type) {
            case 'module':
                $generator->generateModule($name);
                break;
            case 'controller':
                $generator->generateController($name);
                break;
            case 'service':
                $generator->generateService($name);
                break;
            case 'repository':
                $generator->generateRepository($name);
                break;
            default:
                echo "Error: Unknown type '{$type}'\n";
                exit(1);
        }
    } catch (Exception $e) {
        echo "Error: " . $e->getMessage() . "\n";
        exit(1);
    }
}
